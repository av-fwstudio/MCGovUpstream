{% set total_count = rows|length %}
{% set current_month_count = 0 %}

{% set current_month = "now"|date("m") %}
{% set current_year = "now"|date("Y") %}

{% for row in rows %}
	{# Access raw date value from a known field (adjust field name accordingly) #}
	{% set date_string = row.fields.field_date.raw|default(null) %}
	{% if date_string %}
		{% set item_month = date(date_string)|date("m") %}
		{% set item_year = date(date_string)|date("Y") %}
		{% if item_month == current_month and item_year == current_year %}
			{% set current_month_count = current_month_count + 1 %}
		{% endif %}
	{% endif %}
{% endfor %}
<div class="dashboard-card blue">
	<div class="dashboard-header">
		<div class="dashboard-title">
			<img src="{{ directory }}/assets/images/img_icon_notifications.svg" alt="Notifications" style="width: 32px; height: 34px;"/>
			What's New
		</div>
		<div style="display: flex; align-items: center; gap: 10px;">
			<span class="dashboard-badge">5 New</span>
			<div style="background-color: #0056d0; border-radius: 4px; padding: 8px;">
				<button class="dashboard-play-btn"><img src="{{ directory }}/assets/images/img_vector.svg" alt="Arrow" style="width: 14px; height: 14px;"/></button>
			</div>
		</div>
	</div>
	<div class="dashboard-stats">
		<div class="stat-item">
			<div class="stat-number red">{{ current_month_count }}</div>
			<div class="stat-label">This Month</div>
		</div>
		<div class="stat-item">
			<div class="stat-number red">{{ total_count }}</div>
			<div class="stat-label">Total</div>
		</div>
		<div class="stat-item">
			<div class="stat-number">98%</div>
			<div class="stat-label">Updated</div>
		</div>
	</div>
	<div class="dashboard-content ">
		<div class="notification-marquee">
			{{ rows}}
		</div>
	</div>
	<a href="/services/whats-new" class="view-more-btn">
		<img src="{{ directory }}/assets/images/img_icons_5.svg" alt="Icon" style="width: 24px; height: 24px;"/>
		View More
	</a>
</div>
